---
title: DDL Statements
description: 'creating tables and views in Arroyo SQL'
---

In addition to its SELECT capabilities Arroyo supports several Data Description Language (DDL) capabilities.

## CREATE TABLE

Arroyo's CREATE TABLE statements come in three flavors: Create Table As, Memory Table and Connection Table.

### CREATE TABLE AS

This command creates a table from the query included in it, e.g.

```sql
CREATE TABLE orders AS SELECT customer_id, order_id FROM orders;
```

The schema is inferred from the query and other queries within the same context can select from the new table.

### CREATE TABLE (In-Memory)

CREATE TABLE statements without any connection info are presumed to be in
memory. It can be written to within the same query context and then read from. A
memory table may be used in only one `INSERT INTO` statement, but can then be
selected from multiple times. For example, you could create an `orders` table
with a statement like

```sql
CREATE TABLE orders (customer_id INT, order_id INT);
```

`CREATE VIEW` is simply an alias for creating a memory table.

### CREATE TABLE (Connection)

Connection tables allow Arroyo to read and write to external systems like Kafka
clusters. Connections tables may be used as sources, sinks, or both depending on
the type of connection. For details on all of the supported connectors, see the
[Connectors](/connectors) docs. Connection tables can be created via the
Connections tabs of the Web UI, or directly in SQL via the `CREATE TABLE`
statement.

Connection tables are created via special `CREATE TABLE` statements that
include a `WITH` clause. The `WITH` clause specifies the connector, the format
that the data is encoded with, and various other options that are specific to
the connector. The general form of the statement is:

```sql
CREATE TABLE <table name> (
  [<field name> <field type>,]..
) WITH (
  connector = '<connector name>',
  format = '<format name>',
  [connection options]
)
```

where `connector` is one of the connectors documented [here](/connectors) and
format is one of:

* `json`
* `debezium_json`
* `protobuf`
* `avro`
* `raw_string`

(note protobuf and avro support are still in progress).

For example, to create a Kafka source for the topic 1order_topic`:

```sql
CREATE TABLE orders (
  customer_id INT,
  order_id INT,
  date_string TEXT,
  event_time TIMESTAMP GENERATED ALWAYS AS (CAST(date_string as TIMESTAMP)),
  watermark TIMESTAMP GENERATED ALWAYS AS (CAST(date_string as TIMESTAMP) - INTERVAL '15' SECOND
) WITH (
  connector = 'kafka',
  format = 'json',
  type = 'source',
  bootstrap_servers = 'localhost:9092',
  topic = 'order_topic',
  event_time_field = 'event_time',
  watermark_field = 'watermark'
);
```


#### Options

Connection tables allow you to configure a number of options that specify and
modify the behavior. They are specified via the `WITH` clause, with an unquoted
key and a single or double-quoted value. The following options are supported
across all connections. Specific connections have their own options. To see all
of the supported options, refer to the [Connector](/connectors) docs.


| Option           | required  | Description |
|--------          | --------- |-------------|
| `connector`      | required  | The name of the connector to use.|
| `format`         | required  | The format of the data to be deserialized. |
| `format_options.confluent_schema_registry` | optional | If set to `true`, confluent schema registry decoding will be used |
| `event_time_field`  | The name of the field to use as the [event time](/concepts#event-time). If not specified, the event time will be set by the source.|
| `watermark_field`   | The name of the field to use as the [watermark](/concepts#watermark). If not specified, the watermark will be 1 second before the event time. This will usually be the event_time_field minus some constant interval, e.g. `event_time - interval '10 seconds'`.|

#### Virtual Fields

Virtual fields can be created within the `CREATE TABLE` statement.
These are done using the `GENERATED ALWAYS AS (expression)` syntax.
`expression` must be a valid Arroyo SQL expression that only depends on non-virtual fields within the table.
These will primarily be used to specify event time and watermark fields,
as most other use cases can be handled by the `SELECT` statement.

## INSERT INTO

Arroyo supports INSERT INTO statements for both memory and connection tables. In
line with standard SQL the insertion will happen column-wise, attempting
coercion to the SQL types. For example, if you have a memory table `orders` with
columns `customer_id` and `order_id` you could insert into it with a statement
like

```sql
INSERT INTO orders SELECT customer, order FROM source_table;
```

If the table is a connection table this will result in a sink,
otherwise it will be a memory table that can then be read from.
